\chapter{Background}

\todo{\chapabstract{}}

\paragraph{Prerequisites} Quantum Circuits $\cdot$

\section{Monoidal categories}
Monoidal categories give an abstract structure for processes with both sequential and parallel composition. One could be tempted to think of sequential composition as time-like and parallel composition as space-like, but this notion should be resisted as it can mislead in, for example, quantum theory.  A process $f:A\to B$ is a \emph{morphism} from some input $A$ to output $B$. The $A$ and $B$ are called \emph{objects} and we sometimes say that $f$ is a morphism \emph{between} them. For morphisms $f:A\to B$ and $g:B\to C$, their \emph{composite} is a morphism $g\circ f:A\to C$. This data can be structured into a category, which then embodies the notion of sequential composition.\footnote{As a foundational comment, categories in the broadest mathematical literature do not in general require their objects and morphism to be sets. Categories where they do, as defined and used in this thesis, are \emph{small} categories. These details relate to the role categories can play in mathematical foundations \cite{mac1969one}.} We sometimes leave the objects of morphisms implicit when they can be inferred from context.

\begin{defn}
A \emph{category} \cat{C} is a set of objects $\objs{C}$ and a set of morphisms $\arrs{C}$ between them, such that for all $A,C,B,D\in \objs{C}$ and all $f:A\to B$, $g:B\to C$, $h:C\to D$ in $\arrs{C}$:
\begin{itemize}
\item for every pair of morphisms $f,g$, their composite $g\circ f$ is also in $\arrs{C}$;
\item composition is associative:
\begin{align}
h\circ(g\circ f) = (h\circ g)\circ f
\end{align}
\item for every object $A$ there is an $\idm{A}:A\to A$ in $\arrs{C}$ called the \emph{identity morphism} such that for all $f$:
\begin{align}
\idm{B}\circ f = f = f\circ\idm{A}.
\end{align}
\end{itemize}
\end{defn}
 
\todo{defn functor?}

A category can thus be thought of as encoding processes where sequences can be associatively composed  and where we always have access to a ``do-nothing`` process, which is the identity morphism. Note that the objects of a category are somewhat superfluous, as they are in one-to-one correspondence with the identity morphisms. Due to this we refer interchangeable to an object and its identity morphism throughout. It is because categories are really focused on morphisms that we seem them as encoding a process theory.

Morphisms and their compositions can be represented in string diagrams:
\begin{equation}
\label{eq:composition}
\input{tikz/1_compositionGraphical.tikz}
\end{equation}
\noindent Here vertical connectivity, read from bottom to top, represents the flow of morphism composition.

\begin{defn}
A (strict)\footnote{Throughout this thesis we take monoidal categories to be strict, i.e. whose associators and unitors are identities.  In fact, every monoidal category is monoidally equivalent to a strict monoidal one \cite{joyal1993braided}.} \emph{monoidal category} is a category $\cat{C}$ equipped with a \emph{categorical tensor} $(-\otimes-):\cat{C}\times\cat{C}\to\cat{C}$ and a \emph{unit object} $I\in\objs{C}$ that obey:
\begin{equation}
(A\otimes B)\otimes C = A\otimes(B\otimes C),
\end{equation}
\begin{equation}
I\otimes A = A = A\otimes I.
\end{equation}
\end{defn}

Tensor composition is represented by horizontal adjoins and the identity object is the ``empty" diagram:
\begin{equation}
\label{eq:tensor}
\input{tikz/1_tensorGraphical.tikz}
\end{equation}

\begin{defn}
\label{defn:state}
A \emph{state} of $A\in\objs{C}$ is a morphism $\ket{\psi}:I\to A$ drawn as
\begin{equation}
\label{eq:state}
\input{tikz/1_stateDef.tikz}
\end{equation}
\end{defn}

\noindent The state morphism can be thought of as a preparation process to create that state.

\begin{defn}
A monoidal category is \emph{symmetric} (an SMC) when it has a isomorphism
$\sigma_{A,B}:A\otimes B\to B\otimes A$ that satisfies the following graphical equations:
\begin{equation}
\label{eq:symmetry}
\input{tikz/1_symmetryDef.tikz}
\end{equation}
\begin{equation}
\label{eq:symmetry2}
\input{tikz/1_symmetryDef2.tikz}
\end{equation}
\begin{equation}
\label{eq:symmetry3}
\input{tikz/1_symmetryDef3.tikz}
\end{equation}
\end{defn}
\noindent where Equation \ref{eq:symmetry3} is the naturality of $\sigma$.

\begin{examples}
The following are some examples of SMC's:
\begin{itemize}
\item \cat{FHilb}, the category where objects are finite dimensional Hilbert spaces; morphisms are linear maps; the categorical tensor is the tensor product; the identity object $I=\mathbb{C}$.
\end{itemize}
\end{examples}

\begin{theorem}{\cite[Thm 2.3]{joyal1991geometry}}
A well-formed equation between morphisms in a symmetric monoidal category follows from the axioms if and only if it holds in the graphical language up to isomorphism of diagrams.
\end{theorem}

\subsection{Symmetric Monoidal Categories \&\ Quantum Circuits}
This thesis applies the graphical calculi for SMC's to the study of protocols and algorithms for and inspired by quantum theory. For this, it can be useful to think of the SMC graphical calculus as mathematical scaffolding that underlies quantum circuit diagrams. See Figure \ref{fig:QCDSMC} for an example. Note that state preparation is included as a part of the categorical diagram while it is extra labeling in the quantum circuit. In $\cat{FHilb}$ we have $I=\mathbb{C}$, and so the states, by Definition \ref{defn:state}, of some Hilbert space $\Hsp$ are exactly maps $\ket{\psi}:\mathbb{C}\to\Hsp$. These are recognized as the usual quantum state vectors $\ket{\psi}\in\Hsp$. This allows states to be manipulated graphically as well, to advantages discussed later. In uncovering SMC scaffolding of quantum circuits, we are able to improve it, introducing techniques to reason graphically about more advanced structures and that better capture the salient features of these processes. We cover these new features in Sections \ref{sec:AbstractLinAlg}, \ref{sec:AbstractProcTh} and Chapter \ref{chap:cqm}.

\begin{figure}[t]
\label{fig:QCDSMC}
\input{figures/1_QCDSMC.tex}
\caption[Comparison of quantum circuits and symmetric monoidal diagrams]{On the left we have a quantum circuit (read left to right) and its corresponding categorical diagram in \cat{FHilb} on the right (read bottom to top). In both depictions, the boxes are linear maps and the wires are Hilbert spaces. In quantum circuits these are implicitly qubits, with a slash used to denote products of qubits. In the categorical diagram we explicitly write spaces.}
\end{figure}

\subsection{Further Reading}
Other examples of ways that monoidal cats formalize diagrammatic languages in physics etc.  Categories in Control. Penrose diagrams. Feynman diagrams. Etc.  Note that monoidal categories are themselves coherent for planar isotopy \cite{joyal1991geometry}. Indeed the coherence of many of these graphical languages can be regarded are geometric isotopies in higher dimensions, e.g. coherence for SMC's is up to a 4-dimensional isotopy \cite{selinger2011survey}.

\section{Abstract linear algebra}
\label{sec:AbstractLinAlg}
In this section concepts are introduced that expand categorical diagrams beyond quantum circuits.

\begin{defn}
\label{defn:scalar}
A \emph{scalar} in a SMC a morphism $a:I\to I$. As maps from the empty diagram to the empty diagram they are unsurprisingly represented as:
\begin{equation}
\begin{tikzpicture}[xscale={\tikzxscale}, yscale={\tikzyscale}]
\node [whitedot] (0) at (-1, -0) {$a$};
\end{tikzpicture}
\end{equation}
\end{defn}

This categorical view of scalars was made explicit in \cite{abramsky2004categorical}. To gain perspective on why these properly represent scalars, we consider two facts.  Firstly, these scalars form a commutative monoid under categorical composition \cite[Prop 6.1]{kelly1980coherence}, as naturally expressed by:
\begin{equation}
\begin{aligned}
\begin{tikzpicture}[xscale={\tikzxscale}, yscale={\tikzyscale}]
\node [whitedot] (0) at (-1, -0) {$a$};
\node [whitedot] (0) at (-1, -2) {$b$};
\end{tikzpicture}
\end{aligned}
\;=\;
\begin{aligned}
\begin{tikzpicture}[xscale={\tikzxscale}, yscale={\tikzyscale}]
\node [whitedot] (0) at (-1, -0) {$b$};
\node [whitedot] (0) at (-1, -2) {$a$};
\end{tikzpicture}
\end{aligned}
\end{equation}
\noindent Secondly, in $\cat{FHilb}$ they correspond exactly to the complex numbers, as linear maps $\mathbb{C}\to\mathbb{C}$.

\begin{defn}
\label{defn:dagger}
A \emph{dagger functor} on a category \cat{C} is an involutive contravariant functor $\dagger:\cat{C}\to\cat{C}$ that is the identity on objects. A \emph{dagger category} is a category equipped with a dagger functor.
\end{defn}
Spelling out this definition, the dagger functor has the following properties for $f,g:\arrs{C}$ with suitable types and $A\in\objs{C}$:
\begin{equation}
\left(f^{\dagger}\right)^{\dagger} = f 
\end{equation}
\begin{equation}
(g\circ f)^{\dagger} = f^{\dagger}\circ g^{\dagger}
\end{equation}
\begin{equation}
\idm{A}^{\dagger} = \idm{H}
\end{equation}
Thus for any $f:A\to B$ in a dagger category, its dagger or \emph{adjoint} $f^{\dagger}:B\to A$ also exists. We use the shorthand dagger-SMC for a dagger symmetric monoidal category.

The quantum setting \cat{FHilb} is a dagger category whose canonical dagger is the adjoint.  The categorical dagger from Definition \ref{defn:dagger} allows us to generalize many familiar terms, following \cite{abramsky2004categorical}:
\begin{defn}
A morphism $f:A\to B$ in a dagger category is:
\begin{itemize}
\item \emph{self-adjoint} when $f^{\dagger} = f$;
\item a \emph{projector} when self-adjoint and $f\circ f = f$
\item an \emph{isometry} when $f \circ \dag{f} = \idm{A}$;
\item \emph{unitary} when both $f \circ \dag{f} = \idm{A}$ and $f\circ\dag{f} = \idm{B}$;
\item \emph{positive} when $f = \dag{g}\circ g$ for some morphism $g:H\to K$.
\end{itemize}
\end{defn}

The dagger is graphically depicted as an operation on diagrams: it flips the picture upside-down around the horizontal axes.  As a visual aid, morphisms are now drawn with broken symmetry as follows:
\begin{equation}
\label{eq:daggerPics}
\input{tikz/1_daggerPics.tikz}
\end{equation}

Thus the unitarity condition becomes:
\begin{equation}
\label{eq:unitarityPics}
\input{tikz/1_unitarityPics.tikz}
\end{equation}

\begin{defn}
In a dagger-SMC, \emph{effects} on an object $A$ are morphisms $\bra{\psi}:A\to I$.
\end{defn}
\noindent There can certainly be morphisms of this type in any monoidal category, but the dagger gives them their process theoretic interpretation: just as some preparation $a:I\to A$ prepares system $A$ in that state, the effect $\dag{a}:A\to I$ eliminates the system $A$ by the process $\dag{a}$.  \todo{this is a duality}.  Generalized \emph{inner products} are compositions of states and effects \cite{abramsky2004categorical} that are reminiscent of the usual Dirac notation:
\begin{equation}
\left(
\begin{aligned}
\begin{tikzpicture}[xscale=\tikzxscale, yscale=\tikzyscale]
\node (1) [state] at (0, -0.75) {$\psi$};
\node (2) at (0, 0.75) {};
\draw (1.center) to (2.center);
\end{tikzpicture}
\end{aligned}\right)^{\dagger}
=
\begin{aligned}
\begin{tikzpicture}[xscale=\tikzxscale, yscale=\tikzyscale]
\node (1) at (0, -0.75) {};
\node (2) [state, hflip] at (0, 0.75) {$\psi$};
\draw (1.center) to (2.center);
\end{tikzpicture}
\end{aligned}
\qquad\qquad
|\phi\rangle\circ\langle\psi| = \langle\phi|\psi\rangle =
\begin{aligned}
\begin{tikzpicture}[xscale=\tikzxscale, yscale=\tikzyscale]
\node (1) [state] at (0, -0.75) {$\psi$};
\node (2) [state, hflip] at (0, 0.75) {$\phi$};
\draw (1.center) to (2.center);
\end{tikzpicture}
\end{aligned}
\end{equation}

\todo{Superpositions? aka sums of diagrams?}

\begin{defn}
\todo{TODO:CONJUGATION}
\end{defn}

\begin{defn}
\todo{Duals?}
\end{defn}

\begin{defn}
\todo{Compact categories?} (closed follows)
\end{defn}

\section{Abstract process theories}
\label{sec:AbstractProcTh}

This section extends the abstract linear algebra in dagger-SMC's to construct a notion of an abstract process theory. 

\subsection{The Generalized Born Rule}

Measurement in these abstract process theories comes from a statement connecting probabilities to inner products in a generalized Born Rule.

\begin{defn}
For a state $X:I\to A$ and an effect $Y:A\to I$ in a dagger-SMC, the probability of outcome $X$ given preparation $Y$ is:
\begin{equation}
\mbox{Prob}(X|Y) = \dag{Y}\circ\dag{X}\circ X\circ Y
\end{equation}
\end{defn}

Diagrammatically this is:
\begin{equation}
\mbox{Prob}(X|Y) \;=\; 
\begin{aligned}
\begin{tikzpicture}[xscale=\tikzxscale, yscale=\tikzyscale]
\node (1) [state] at (0, -0.5) {$Y$};
\node (2) [state, hflip] at (0, 0.5) {$X$};
\draw (1.center) to (2.center);
\node (3) [state] at (0, 3.5) {$X$};
\node (4) [state, hflip] at (0, 4.5) {$Y$};
\draw (3.center) to (4.center);
\end{tikzpicture}
\end{aligned}
\;=\;
\begin{aligned}
\begin{tikzpicture}[xscale=\tikzxscale, yscale=\tikzyscale]
\node (1) [state] at (0, -0.5) {$Y$};
\node (2) [state, hflip] at (0, 0.5) {$X$};
\draw (1.center) to (2.center);
\node (3) [state] at (3, -0.5) {$X$};
\node (4) [state, hflip] at (3, 0.5) {$Y$};
\draw (3.center) to (4.center);
\end{tikzpicture}
\end{aligned}
\end{equation}
While this clearly makes sense in \cat{FHilb}, one might ask when under what general conditions these scalars will corresponding to our usual notion of probability. An answer is found in the following theorem:

\begin{theorem}{\cite[Thm 4.2]{vicary2011completeness}}
In a monoidal dagger-category with simple tensor unit, which has all finite dagger-limits and for which the self-adjoint scalars are Dedekind-complete, the scalars have an involution-preserving embedding into the complex numbers.
\end{theorem}

For any category satisfying these conditions, this embedding can be used, along with appropriate normalization, to extract the real-valued probabilities.

\subsection{Monoids and Comonoids}

Monoids and comonoids on objects embody our notions of copying and comparing states. As they are a particular kinds of morphisms we draw them with distinct pictures. For $A\in\objs{C}$ a monoid $(A,*,1)$ has states of $A$ as elements and maps:
\begin{equation}
\input{tikz/1_monoidPics.tikz}
\end{equation}

\begin{defn}
\label{defn:monoid}
In a monoidal category, a \textit{monoid} is a triple \whitemonoid{A} of an object $A$, a morphism $\tinymult[whitedot] : A \otimes A \to A $ called the multiplication, and a state $\tinyunit[whitedot] : I \to A$ called the unit, satisfying associativity and unitality equations:
\begin{equation}
\label{eq:monoid}
\input{tikz/1_monoid.tikz}
\end{equation}
\end{defn}

\begin{defn}
\label{defn:comonoid}
In a monoidal category, a \textit{comonoid} is a triple \whitecomonoid{A} of an object $A$, a morphism $\tinycomult[whitedot] : A \to A \otimes A$ called the comultiplication, and an effect $\tinycounit[whitedot] : A \to I$ called the counit, satisfying coassociativity and counitality equations:
\begin{equation}
\label{eq:comonoid}
\input{tikz/1_comonoid.tikz}
\end{equation}
\end{defn}

\begin{defn}
In a monoidal category and object $A$, a \emph{monoid homomorphism} $f:\whitemonoid{A}\to\blackmonoid{A}$ is a map $f:A\to A$ such that
\begin{equation}
\label{eq:mon_hom}
\input{tikz/1_mon_hom.tikz}
\end{equation}
\end{defn}
\noindent A \emph{comonoid homomorphism} is defined similarly, but with the dagger condition to Equation \ref{eq:mon_hom}.

We can then ask for the comonoid and monoid to interact in various ways.

\subsection{Observables}

\begin{defn}
In a monoidal dagger-category, the pair of a monoid \whitemonoid{A} and comonoid \whitecomonoid{A} is \emph{dagger-Frobenius} when the following equation holds:
\begin{equation}
\label{eq:frobenius}
\input{tikz/1_Frobenius.tikz}
\end{equation}
\end{defn}

\begin{defn}
In a symmetric monoidal dagger-category, a \textit{classical structure} is a commutative dagger-Frobenius comonoid \whitecomonoid{A} satisfying the \textit{specialness} condition:
\begin{equation}
\input{tikz/1_specialness.tikz}
\end{equation}
\end{defn}


\begin{defn}
In a symmetric monoidal dagger-category, a dagger-Frobenius comonoid is \emph{symmetric} when the following condition holds:
\begin{equation}
\input{tikz/1_symmetric.tikz}
\end{equation}
\end{defn}

\begin{defn}
In a symmetric monoidal dagger-category, the \emph{dimension} $d(A)$ of an object $A$ equipped with a dagger-Frobenius comonoid \whitecomonoid{A} is given by the following composite:
\begin{equation}
\label{eq:dim}
\input{tikz/1_dimension.tikz}
\end{equation}
\end{defn}
\noindent
When the algebra is commutative and special, Equation~\eqref{eq:dim} can be simplified to the composition of the unit and counit.

\begin{defn}
\todo{copyable states}
\end{defn}

\begin{theorem}{Gelfand-Neumark}
Special dagger Frobenius algebras in \cat{FHilb} are precisely finite-dimensional C$^*$-algebras.
\end{theorem}

\begin{theorem}{\cite[Thm 5.1]{coecke2013new}}
Commutative dagger Frobenius algebras in FHilb are orthogonal bases.
\end{theorem}

\begin{defn}
A \emph{classical structure} in a SMC is a dagger special commutative Frobenius algebras ($\dagger$-sCFA).
\end{defn}
\noindent Classical structures are bases in \cat{FHilb} and so are recognized as generalized \emph{observables} in an abstract process theory.

\begin{theorem}{\cite[Sec 6]{coecke2013new}}
\label{thm:cstructBases}
Classical structures in FHilb are orthonormal bases.
\end{theorem}

\noindent The copyable states form the elements of these bases.

\begin{remark}
The correspondence in Theorem \ref{thm:cstructBases} was modified for the infinite dimensional case in \cite{abramsky2012h}.
\end{remark}

\begin{theorem}
\todo{Normal Forms/Spider law: cqm-notes Lemma 5.21}
\end{theorem}

\begin{corollary}
In \cat{FHilb}, a morphism between commutative dagger Frobenius structures acts as a function on copyable states if and only if it is a comonoid homomorphism.
\end{corollary}

The says that functions that map from one basis to another will necessarily be comonoid homomorphisms.  We will generalize this when we consider oracles in quantum algorithms.

\begin{defn}
In a monoidal dagger-category, a comonoid homomorphism \\$f:\blackcomonoid{A} \to \graycomonoid{B}$ between dagger-Frobenius comonoids is \emph{self-conjugate} when the following property holds:
\begin{equation}
\label{eq:comonoidhomomorphismselfconjugate}
\begin{aligned}
\begin{tikzpicture}[xscale=1.4*\tikzxscale, yscale=1.4*\tikzyscale]
\node [morphism, wedge] (f) at (2,1) {$f$};
\draw (0,-1) to [out=up, in=left, in looseness=0.9] (1,2) node [graydot] {} to (1,2.5) node [graydot] {};
\draw (1,2) to [out=right, in=up] (f.north);
\draw (f.south) to [out=down, in=left] (3,0) node [blackdot] {} to [out=right, in=down, out looseness=0.9] (4,3);
\draw (3,0) to (3,-0.5) node [blackdot] {};
\node [graydot] at (1,2) {};
\end{tikzpicture}
\end{aligned}
\quad=\quad
\begin{aligned}
\begin{tikzpicture}[string]
\node (f) at (0,0) [morphism, wedge, hflip] {$f$};
\draw (0,-1.5) to (f.south);
\draw (f.north) to (0,1.5);
\end{tikzpicture}
\end{aligned}
\end{equation}
\end{defn}

\begin{lemma}
\label{lem:comonoidhomomorphismselfconjugate}
In {\bf Hilb}, comonoid homomorphisms $f:\blackcomonoid{A} \to \graycomonoid{B}$ of classical structures are self-conjugate.
\end{lemma}


\begin{proof}
Recall that comonoid homomorphisms between classical structures in \cat{Hilb} are exactly classical functions between the copyable points~\cite{coecke2013new}. The linear maps on either side of~\eqref{eq:comonoidhomomorphismselfconjugate} will be the same if and only if their matrix elements are the same, obtained by composing with $\ket i$ at the bottom and $\bra j$ at the top. On the left-hand side, this gives the following result:
\begin{equation}
\begin{aligned}
\begin{tikzpicture}[xscale=1.4*\tikzxscale, yscale=1.4*\tikzyscale]
\node [morphism, wedge] (f) at (2,1) {$f$};
\draw (0,0) node [state] {$i$} to [out=up, in=left, in looseness=0.9] (1,2) node [graydot] {} to (1,2.5) node [graydot] {};
\draw (1,2) to [out=right, in=up] (f.north);
\draw (f.south)
    to [out=down, in=left] (3,0)
        node [blackdot] {}
    to [out=right, in=down, out looseness=0.9] (4,2)
        node [state, hflip] {$j$};
\draw (3,0) to (3,-0.5) node [blackdot] {};
\end{tikzpicture}
\end{aligned}
\quad=\quad
\begin{aligned}
\begin{tikzpicture}[xscale=1.4*\tikzxscale, yscale=1.4*\tikzyscale]
\node (f) [morphism, wedge] at (0,0) {$f$};
\draw (0,-0.75) node [state] {$j$} to (f.south);
\draw (0,0.75) node [state, hflip] {$i$} to (f.north);
\end{tikzpicture}
\end{aligned}
\quad=\quad
\left\{
\begin{array}{ll}
1 & \text{ if } i=f(j), \\
0 & \text{ if } i \neq f(j).
\end{array}
\right.
\end{equation}
On the right we can do this calculation:
\begin{equation}
\begin{aligned}
\begin{tikzpicture}[xscale=1.4*\tikzxscale, yscale=1.4*\tikzyscale]
\node (f) [morphism, wedge, hflip] at (0,0) {$f$};
\draw (0,-0.75) node [state] {$i$} to (f.south);
\draw (0,0.75) node [state, hflip] {$j$} to (f.north);
\end{tikzpicture}
\end{aligned}
\quad=\quad
\left(
\begin{aligned}
\begin{tikzpicture}[xscale=1.4*\tikzxscale, yscale=1.4*\tikzyscale]
\node (f) [morphism, wedge] at (0,0) {$f$};
\draw (0,-0.75) node [state] {$j$} to (f.south);
\draw (0,0.75) node [state, hflip] {$i$} to (f.north);
\end{tikzpicture}
\end{aligned}
\right) ^\dagger
\quad=\quad
\left\{
\begin{array}{ll}
1 & \text{ if } i=f(j) \\
0 & \text{ if } i \neq f(j)
\end{array}
\right\}^\dagger 
\quad = \quad
\left\{
\begin{array}{ll}
1 & \text{ if } i=f(j), \\
0 & \text{ if } i \neq f(j).
\end{array}
\right.
\end{equation}
This is the same result as for the left-hand side, and so Equation~\eqref{eq:comonoidhomomorphismselfconjugate} holds.
\end{proof}

