\chapter{Structures in Generalized Compositional Theories}
\label{chap:cqm}

\todo{\chapabstract{}}

In this chapter we further develop the categorical structure into a notion of an generalized compositional theory. Many of the properties developed here, while still general, are extensions of ideas from quantum theory, e.g. complementarity.  Generalized compositional theories that posses these properties can be considered quantum-like.

\section{The dagger}
In this section concepts are introduced that expand categorical diagrams beyond quantum circuits. We see that abstract linear algebra can be introduced to our diagrams by adding a so-called \emph{dagger functor}.  In the case of \cat{FHilb} this corresponds with the familiar notion of adjoint (complex-transpose).  The addition of the dagger also allows us to recognize symmetric monoidal categories (not just \cat{FHilb}) as a kind of generalized compositional theory. 

\begin{defn}
\label{defn:dagger}
A \emph{dagger functor} on a category \cat{C} is an involutive contravariant functor $\dagger:\cat{C}\to\cat{C}$ that is the identity on objects. A \emph{dagger category} is a category equipped with a dagger functor.
\end{defn}
Spelling out this definition, the dagger functor has the following properties for $f,g:\arrs{C}$ with suitable types and $A\in\objs{C}$:
\begin{equation}
\left(f^{\dagger}\right)^{\dagger} = f 
\end{equation}
\begin{equation}
(g\circ f)^{\dagger} = f^{\dagger}\circ g^{\dagger}
\end{equation}
\begin{equation}
\idm{A}^{\dagger} = \idm{A}
\end{equation}
Thus for any $f:A\to B$ in a dagger category, its dagger or \emph{adjoint} $f^{\dagger}:B\to A$ also exists. We use the shorthand $\dagger$-SMC for a dagger symmetric monoidal category.

The quantum setting of \cat{FHilb} is a dagger category whose canonical dagger is the adjoint, and generalizing it in the manner of Definition \ref{defn:dagger} allows us to generalize many familiar terms, following \cite{abramsky2004categorical}:
\begin{defn}
A morphism $f:A\to B$ in a dagger category is:
\begin{itemize}
\item \emph{self-adjoint} when $f^{\dagger} = f$;
\item a \emph{projector} when self-adjoint and $f\circ f = f$
\item an \emph{isometry} when $f \circ \dag{f} = \idm{A}$;
\item \emph{unitary} when both $f \circ \dag{f} = \idm{A}$ and $f\circ\dag{f} = \idm{B}$;
\item \emph{positive} when $f = \dag{g}\circ g$ for some morphism $g:H\to K$.
\end{itemize}
\end{defn}

\noindent These concepts both have meaning as mathematical objects in linear algebra and as information theoretic concepts in a process theory.  For example, a projector is some process where multiple sequential applications have the same effect as a single application in the broadest possible sense.

Further, the dagger can be intuitively extended to an operation on diagrams: it flips the picture upside-down around the horizontal axes.  As a visual aid, morphisms are now drawn with broken symmetry as follows:
\begin{equation}
\label{eq:daggerPics}
\input{tikz/1_daggerPics.tikz}
\end{equation}

Thus the unitarity condition becomes:
\begin{equation}
\label{eq:unitarityPics}
\input{tikz/1_unitarityPics.tikz}
\end{equation}

The next two definitions, that of \emph{scalars} and \emph{effects}, further our understanding of $\dagger$-SMC's as generalized compositional theories with additional structure that allows us to define a generalized version of the Born Rule that provides a basic notion of measurement.

\begin{defn}
\label{defn:scalar}
A \emph{scalar} in a SMC a morphism $a:I\to I$. As these are maps from the empty diagram to the empty diagram they are unsurprisingly represented as:
\begin{equation}
\begin{tikzpicture}[xscale={\tikzxscale}, yscale={\tikzyscale}]
\node [whitedot] (0) at (-1, -0) {$a$};
\end{tikzpicture}
\end{equation}
\end{defn}

This categorical view of scalars was made explicit in \cite{abramsky2004categorical}. To gain perspective on why these properly represent scalars, we consider two facts.  Firstly, these scalars form a commutative monoid under categorical composition \cite[Prop 6.1]{kelly1980coherence}, as naturally expressed by:
\begin{equation}
\begin{aligned}
\begin{tikzpicture}[xscale={\tikzxscale}, yscale={\tikzyscale}]
\node [whitedot] (0) at (-1, -0) {$a$};
\node [whitedot] (0) at (-1, -2) {$b$};
\end{tikzpicture}
\end{aligned}
\;=\;
\begin{aligned}
\begin{tikzpicture}[xscale={\tikzxscale}, yscale={\tikzyscale}]
\node [whitedot] (0) at (-1, -0) {$b$};
\node [whitedot] (0) at (-1, -2) {$a$};
\end{tikzpicture}
\end{aligned}
\end{equation}
\noindent Secondly, in $\cat{FHilb}$ they correspond exactly to the complex numbers, as linear maps~$\mathbb{C}\to\mathbb{C}$.

\begin{defn}
In a \dsmc, \emph{effects} on an object $A$ are morphisms $\bra{\psi}:A\to I$.
\end{defn}
\noindent There can certainly be morphisms of this type in any monoidal category, but the dagger gives them their process theoretic interpretation: just as some preparation $a:I\to A$ prepares system $A$ in that state, the effect $\dag{a}:A\to I$ eliminates the system $A$ by the process $\dag{a}$.  This duality presents generalized \emph{inner products} as compositions of states and effects \cite{abramsky2004categorical} that are reminiscent of the usual Dirac notation:
\begin{equation}
\left(
\begin{aligned}
\begin{tikzpicture}[xscale=\tikzxscale, yscale=\tikzyscale]
\node (1) [state] at (0, -0.75) {$\psi$};
\node (2) at (0, 0.75) {};
\draw (1.center) to (2.center);
\end{tikzpicture}
\end{aligned}\right)^{\dagger}
=
\begin{aligned}
\begin{tikzpicture}[xscale=\tikzxscale, yscale=\tikzyscale]
\node (1) at (0, -0.75) {};
\node (2) [state, hflip] at (0, 0.75) {$\psi$};
\draw (1.center) to (2.center);
\end{tikzpicture}
\end{aligned}
\qquad\qquad
|\phi\rangle\circ\langle\psi| = \langle\phi|\psi\rangle =
\begin{aligned}
\begin{tikzpicture}[xscale=\tikzxscale, yscale=\tikzyscale]
\node (1) [state] at (0, -0.75) {$\psi$};
\node (2) [state, hflip] at (0, 0.75) {$\phi$};
\draw (1.center) to (2.center);
\end{tikzpicture}
\end{aligned}
\end{equation}

\section{The generalized Born rule}

Measurement in these generalized compositional theories comes from a statement connecting probabilities and inner products in a sense that approaches a generalized Born Rule. For a state $X:I\to A$ and an effect $Y:A\to I$ in a $\dagger$-SMC, the amplitude of outcome $X$ given preparation $Y$ is:
\begin{equation}
a = X\circ Y:\mathbb{I}\to\mathbb{I}
\end{equation}

%Diagrammatically this is:
%\begin{equation}
%\mbox{Prob}(X|Y) \;=\; 
%\begin{aligned}
%\begin{tikzpicture}[xscale=\tikzxscale, yscale=\tikzyscale]
%\node (1) [state] at (0, -0.5) {$Y$};
%\node (2) [state, hflip] at (0, 0.5) {$X$};
%\draw (1.center) to (2.center);
%\node (3) [state] at (0, 3.5) {$Y^{*}$};
%\node (4) [state, hflip] at (0, 4.5) {$X^{*}$};
%\draw (3.center) to (4.center);
%\end{tikzpicture}
%\end{aligned}
%\;=\;
%\begin{aligned}
%\begin{tikzpicture}[xscale=\tikzxscale, yscale=\tikzyscale]
%\node (1) [state] at (0, -0.5) {$Y$};
%\node (2) [state, hflip] at (0, 0.5) {$X$};
%\draw (1.center) to (2.center);
%\node (3) [state] at (3, -0.5) {$Y^{*}$};
%\node (4) [state, hflip] at (3, 0.5) {$X^{*}$};
%\draw (3.center) to (4.center);
%\end{tikzpicture}
%\end{aligned}
%\end{equation}

\noindent We could then define the operational probability Prob$(X|Y)=|a|^2$. While this clearly makes sense in \cat{FHilb}, where amplitudes are complex numbers, one might ask when under what general conditions the scalars $I\to I$ will square to our usual notion of probability. An answer is found in the following theorem:
\begin{theorem}{\cite[Thm 4.2]{vicary2011completeness}}
In a monoidal dagger-category with simple tensor unit, which has all finite dagger-limits and for which the self-adjoint scalars are Dedekind-complete, the scalars have an involution-preserving embedding into the complex numbers.
\end{theorem}
\noindent For any category satisfying these conditions, this embedding can be used, along with appropriate normalization, to extract the real-valued probabilities. Still, even if the scalars do not embed in the complex numbers one can generally handle the needed structure of complex conjugation to obtain a generalized Born rule. There is a way to define conjugation in any $\dagger$-SMC which has duals, as we describe in this section.\footnote{These are sometimes called autonomous categories in the literature \cite{joyal1993braided,selinger2011survey}.}

Duals in a generalized compositional theory help us define both entanglement and conjugation.

\begin{defn}
\label{def:dual}
In a $\dagger$-SMC, a system $A$ has a\footnote{In general, there can be separate left and right duals for an object in any category, where the definition given here corresponds to a left dual. In a \dsmc(in fact in any braided monoidal category with left duals), these are necessarily equal, so we need only speak of one dual~\cite[Prop.~7.2]{joyal1993braided}. } \emph{dual} system $A^*$ if there exist processes 
\begin{align}
e_A:I\to A^*\otimes A \quad \mbox{and}\quad d_A:A\otimes A^*\to I
\end{align}
such that the following equations hold:
\begin{align}
(d_A\otimes \idm{A})\circ(\idm{A}\otimes e_A) = \idm{A} \qquad (\idm{A^*}\otimes d_A)\circ(e_A\otimes \idm{A^*})=\idm{A^*}
\end{align}
\end{defn}

When duals are introduced, we common denote them by placing arrows on the objects:
\begin{equation}
\input{tikz/2_arrowdual.tikz}
\end{equation}

Thus the duality maps, commonly called ``cups" and ``caps" and their ``snake equations" have the following diagrammatic form:
\begin{align}
\input{tikz/2_capcup.tikz}
\end{align}
\begin{equation}
\label{eq:snake}
\input{tikz/2_snake.tikz}
\end{equation} 
\noindent and are well behaved under the dagger functor, i.e.
\begin{equation}
\input{tikz/2_daggerdual.tikz}
\end{equation}

We can compose these caps and cups to define the dual of any process $f:A\to B$ as $f^*:B^*\to A^*$:
\begin{equation}
\input{tikz/2_dualmorph.tikz}
\end{equation}

\begin{example}
\label{ex:bellduals}
To get a better handle on what this structure means, we consider the example of \cat{FHilb}. Given some finite dimensional Hilbert space $A\in\objs{FHilb}$, its dual $A^*$ is the usual dual space, i.e. the space of linear functionals $A\to \mathbb{C}$. Note that in this case $A$ is isomorphic to $A^*$, and thus we can canonically map $\bra{i}\mapsto\ket{i}$. Because of this isomorphism, we will often omit the arrows on wires when working in this case. Using this and given a basis $\{ \ket{i} \}$ for $A$, the cups and the caps are maps:
\begin{align}
e_A &:: 1\mapsto \sum_i\bra{i}\otimes\ket{i}\cong\sum_i\ket{i}\otimes\ket{i}
\\
d_A &:: \sum_i\ket{i}\otimes\bra{i}\cong\sum_i\bra{i}\otimes\bra{i} \mapsto 1
\end{align}
We then immediately recognize $e_A$ as entangled state preparation. In particular, when $A$ is a two-dimensional Hilbert space, $e_A$ is a Bell state preparation of $\ket{\psi_{00}}=\ket{00}+\ket{11}$ and  and $d_A$ is a post-selected Bell measurement for $\ket{\psi_{00}}$. For any process in \cat{FHilb} its dual gives the transpose, which is in general the \emph{upper-star} of $f$.
\end{example}

This provides a motivating example for the following, which acts as a generalized conjugation operation:

\begin{defn}
Given a oCGT \cat{C}, the \emph{lower-star} is an involutive map 
\begin{align*}
(-)_*:\arrs{C}&\to\arrs{C} \\
\left(f:A\to B\right) &\mapsto f_*:=(\dag{f})^*=\dag{(f^*)}.
\end{align*}
\end{defn}

This now gives us a way to talk about abstract probabilities for the generalized Born rule:
\begin{defn}[Generalized Born Rule]
\label{def:bornrule}
For a state $X:I\to A$ and an effect $Y:A\to I$ in a $\dagger$-SMC, the probability of outcome $X$ given preparation $Y$ is:
\begin{equation}
\mbox{Prob}(X|Y) = (X\circ Y)^*\otimes X\circ Y:\mathbb{I}\to\mathbb{I}
\end{equation}
\end{defn}
\noindent It is easy to see that this reduces to the usual Born rule in \cat{FHilb}.

\subsection{Operational Generalized Compositional Theories}

The addition of states and a generalized Born rule (with further details in the following section), give our generalized compositional theories a notion of measurement and an operational character.

\begin{defn}(Operational Generalized Compositional Theories)
\label{thm:ogct}
A $\dagger$-SMC where all objects have duals is called a \emph{$\dagger$-compact category}. An \emph{operational generalized compositional theory} (oGCT) is a \dcc where objects are interpreted as systems and morphisms are interpreted as processes.
\end{defn}

Duals and their ``wire-straightening" equations give diagrams in an oGCT a lot of power to encode topological equivalences.  This is well expressed in the following graphical coherence theorem, whose mathematical details are shown in~\cite{selinger2011survey}.

\begin{theorem}[Fundamental Theorem of Diagrams~\cite{coecke2015generalised}]
\label{thm:fund}
Two diagrams in an oGCT are considered equal if one can be smoothly transformed to another by bending, stretching, or crossing wires, and by moving boxes around. Given any two oGCTs $\cat{C}$ and $\cat{D}$ and a map $F:\cat{C}\to\cat{D}$, for any two diagrams $d$ and $d'$ in $\cat{C}$, if $d=d'$ as diagrams then $F(d)=F(d')$ in $\cat{D}$.
\end{theorem}

To recap, we have so far introduced the structures of the dagger and duals, allowing us to compute measurement outcomes by diagrammatic manipulation of the diagrams alone.  This contrasts with the usual quantum circuit formalism, which provides a representation of a protocol, but whose implementation must ultimately be understood through matrix mechanics that accompany it. The use of this difference - the  additional structure of operational generalized compositional theories versus generalized compositional theories - can be illustrated with quantum teleportation, which provides a motivating example and was introduced in this form by~\cite{abramsky2004categorical}.

\begin{example} 
We saw in Example \ref{ex:bellduals} that caps and cups represent preparation and post-selected measurement of one of the Bell states $\ket{\psi_{00}}$. The other Bell states can be prepared and/or measured by the application of a unitary to one of the entangled systems:
\begin{equation}
\begin{pic}[xscale={\tikzxscale}, yscale={\tikzyscale}]
\node (0) at (-1, -0) {};
\node (1) at (1, -0) {};
\node (2) at (0, -1) {};
\node (r) at (1,3) {};
\node (l) at (-1,3) {};
\node [morphism, wedge] (u) at (-1,1) {$U_i$};
\draw (1.center) to (r);
\draw (u.north) to (l);
\draw [bend right=45, looseness=1.00] (u.south) to (2.center);
\draw [bend right=45, looseness=1.00] (2.center) to (1.center);
\end{pic}
\qquad \qquad
\begin{pic}[xscale={\tikzxscale}, yscale={-1*\tikzyscale}]
\node (0) at (-1, -0) {};
\node (1) at (1, -0) {};
\node (2) at (0, -1) {};
\node (r) at (1,3) {};
\node (l) at (-1,3) {};
\node [morphism, wedge, hflip] (u) at (-1,1) {$U_i$};
\draw (1.center) to (r);
\draw (u.south) to (l);
\draw [bend right=45, looseness=1.00] (u.north) to (2.center);
\draw [bend right=45, looseness=1.00] (2.center) to (1.center);
\end{pic}
\end{equation}

A teleportation protocol can then be represented by the process where Alice and Bob share an entangled system that will be used to teleport from Alice to Bob:
\begin{equation}
\input{tikz/2_teleportation.tikz}
\end{equation}
Here the cup map represents the shared Bell state.  Alice performs a Bell measurement on the source system and her half of the entangled system. Bob then performs a unitary that matches Alice's Bell measurement. We can verify the effect of the protocol using purely diagrammatic equivalences:
\begin{equation}
\label{eq:teleportderive}
\input{tikz/2_teleportderive.tikz}
\end{equation}
This presentation of the teleportation protocol is useful in several ways:
\begin{enumerate}
\item This presentation of teleportation make the high level structure of the protocol (the teleportation) immediately manifest without accompanying calculation.
\item It is obvious how to design equivalent teleportation protocols with multiple parties and Bell measurements in more elaborate arrangements, e.g.
\begin{equation}
\input{tikz/2_weirdteleport.tikz}
\end{equation}
\item By specifying the teleportation protocol at the level of oGCTs, we can consider models of teleportation in theories other than quantum theory, i.e. categories other than $\cat{FHilb}$. As an example, the oGCT $\cat{FRel}$ where systems are sets and processes are relations also has entangled states established by duals, where the dagger functor is the relational converse. All the protocol specifications given in this section apply equally well in the $\cat{FRel}$ setting, just as they will in any other oGCT.
\end{enumerate}
\end{example}

Operational generalized compositional theories already give us some power above and beyond the usual quantum circuit formalism, and we add more structures to the toolbox in the next sections.  We have glossed over some of the details of how measurement should be represented in such theories, but the introduction of structures for observables in the next sections allows us to more exactly specify the details in Section \ref{sec:measurements}. 

\section{\todo{Other possibilities if needed}}
\todo{Superpositions? aka sums of diagrams?}

\section{Observables}
\label{sec:observables}

Within a process theory we can construct objects that have the phenomenology of classical information: copying, deleting, etc. These structures become the observables of oGCTs that allow us to extract classical information from them via measurements.

\subsection{Monoids and comonoids}

Monoids and comonoids on systems embody our notions of copying and comparing states. As they are a particular kinds of processes we draw them with distinct pictures. For $A\in\objs{C}$ a monoid $(A,*,1)$ has states of $A$ as elements and maps:
\begin{equation}
\input{tikz/1_monoidPics.tikz}
\end{equation}

\begin{defn}
\label{defn:monoid}
In a monoidal category, a \textit{monoid} is a triple \whitemonoid{A} of an object $A$, a morphism $\tinymult[whitedot] : A \otimes A \to A $ called the multiplication, and a state $\tinyunit[whitedot] : I \to A$ called the unit, satisfying associativity and unitality equations:
\begin{equation}
\label{eq:monoid}
\input{tikz/1_monoid.tikz}
\end{equation}
\end{defn}

\begin{defn}
\label{defn:comonoid}
In a monoidal category, a \textit{comonoid} is a triple \whitecomonoid{A} of an object $A$, a morphism $\tinycomult[whitedot] : A \to A \otimes A$ called the comultiplication, and an effect $\tinycounit[whitedot] : A \to I$ called the counit, satisfying coassociativity and counitality equations:
\begin{equation}
\label{eq:comonoid}
\input{tikz/1_comonoid.tikz}
\end{equation}
\end{defn}

\noindent We use differently colored dots to represent different monoids on the same object.
\begin{defn}
In a monoidal category and object $A$, a \emph{monoid homomorphism} $f:\whitemonoid{A}\to\blackmonoid{A}$ is a map $f:A\to A$ such that
\begin{equation}
\label{eq:mon_hom}
\input{tikz/1_mon_hom.tikz}
\end{equation}
\end{defn}
\noindent A \emph{comonoid homomorphism} is defined similarly, but with the dagger of the condition in~\eqref{eq:mon_hom}.

We can then ask for the comonoid and monoid to interact in various ways.

\subsection{Abstract observables}

When monoids and comonoids combine under certain rules, we obtain the structure of classical information on systems in an oGCT.

\begin{defn}
In a \dsmc the pair of a monoid \whitemonoid{A} and comonoid \whitecomonoid{A} form a \emph{dagger-Frobenius algebra} when the following equation holds:
\begin{equation}
\label{eq:frobenius}
\input{tikz/1_Frobenius.tikz}
\end{equation}
\end{defn}

\begin{defn}
\label{def:classicalstruct}
A \emph{classical structure} is a dagger-Frobenius algebra \whitecomonoid{A} satisfying the \emph{specialness} \eqref{eq:special} and \emph{symmetry} \eqref{eq:sym} conditions:
\begin{equation}
\label{eq:special}
\begin{aligned}
\begin{tikzpicture}[xscale={1.5*\tikzxscale}, yscale={1.5*\tikzyscale}]
\draw (0,0.25) to (0,1) node [whitedot] {} to [out=\nwangle, in=down] (-0.5,1.5) to [out=up, in=\swangle] (0,2) node [whitedot] {} to (0,2.75);
\draw (0,1) to [out=\neangle, in=down] (0.5,1.5) to [out=up, in=\seangle] (0,2);
\end{tikzpicture}
\end{aligned}
\quad=\quad
  \begin{aligned}
  \begin{tikzpicture}[xscale={1.5*\tikzxscale}, yscale={1.5*\tikzyscale}]
  \draw (-0.5,0) to (-0.5,3);
  \end{tikzpicture}
  \end{aligned}
  \end{equation}
  
  \vspace{-10pt}
  \begin{equation}
  \label{eq:sym}
\begin{aligned}
\begin{tikzpicture}[xscale={1.5*\tikzxscale}, yscale={1.5*\tikzyscale}]
\draw (0,-0.5) node [whitedot] {} to (0,0.5) node [whitedot] {} to [out=\nwangle, in=down] (-0.5,1.0) to [out=up, in=down] (0.5,2);
\draw (0,0.5) to [out=\neangle, in=down] (0.5,1) to [out=up, in=down] (-0.5,2);
\end{tikzpicture}
\end{aligned}
\quad=\quad
\begin{aligned}
\begin{tikzpicture}[xscale={1.5*\tikzxscale}, yscale={1.5*\tikzyscale}]
\draw (0,-0.5) node [whitedot] {} to (0,0.5) node [whitedot] {} to [out=\nwangle, in=down] (-0.5,1.0) to [out=up, in=down] (-0.5,2);
\draw (0,0.5) to [out=\neangle, in=down] (0.5,1) to [out=up, in=down] (0.5,2);
\end{tikzpicture}
\end{aligned}
\end{equation}
\end{defn}

\begin{defn}
\label{def:copyables}
The set of \emph{classical states} $K_{\circ}$ for a classical structure \whitecomonoid{A} are all states $j:I\to A$ such that:
\begin{equation}
\label{eq:copy}
\begin{pic}[xscale=\tikzxscale, yscale=-0.8*\tikzyscale]
\node [state] at (1.25,3) {$j$};
\draw (2,0) to [out=up, in=\seangle] (1.25,1.5);
\draw (0.5,0) to [out=up, in=\swangle] (1.25, 1.5);
\draw (1.25,1.5) to (1.25, 3);
\node [whitedot] at (1.25,1.5) {};
\end{pic}
\quad=\quad
\begin{pic}[xscale=\tikzxscale, yscale=\tikzyscale]
\node (a) [state] at (2.5,0) {$j$};
\node (b) [state] at (0,0) {$j$};
\draw (a) to (2.5,2);
\draw (b) to (0,2);
\end{pic}
\end{equation}
\end{defn}
\noindent These classical points will be drawn as states that are the same color as the classical structure to which they correspond. It is also easy to determine the behavior of classical points under composition with the (co)unit:
\begin{equation}
\label{eq:unitscalar}
\begin{pic}[xscale=\tikzxscale, yscale=-0.8*\tikzyscale]
\node [state] at (1.25,3) {$j$};
\draw (1.25,0) to (1.25, 3);
\end{pic}
\;\stackrel{\eqref{eq:comonoid}}{=}\;
\begin{pic}[xscale=\tikzxscale, yscale=-0.8*\tikzyscale]
\node [state] at (1.25,3) {$j$};
\draw (2,0) to [out=up, in=\seangle] (1.25,1.5);
\draw (0.5,0) to [out=up, in=\swangle] (1.25, 1.5);
\draw (1.25,1.5) to (1.25, 3);
\node [whitedot] at (1.25,1.5) {};
\node [whitedot] at (0.5,0) {};
\end{pic}
\quad\stackrel{\eqref{eq:copy}}{=}\quad
\begin{pic}[xscale=\tikzxscale, yscale=\tikzyscale]
\node (a) [state] at (2.5,0) {$j$};
\node (b) [state] at (0,0) {$j$};
\draw (a) to (2.5,2);
\draw (b) to (0,2);
\node [whitedot] at (0,2) {};
\end{pic}
\qquad\Leftrightarrow\qquad
\begin{pic}[xscale=\tikzxscale, yscale=\tikzyscale]

\node (b) [state] at (0,0) {$j$};

\draw (b) to (0,2);
\node [whitedot] at (0,2) {};
\end{pic}
\;=\;1
\end{equation}
\noindent where $1$ is the unit scalar, i.e. $1\circ s = s = s\circ 1$ for all scalars $s$. In this sense the counit ``erases" classical points.

The following theorems characterize the relationship between classical structures and observables. 

\begin{theorem}[{\cite[Cor 4.3]{coecke2013new}}]
Special dagger Frobenius algebras in \cat{FHilb} are precisely finite-dimensional C$^*$-algebras.
\end{theorem}
\noindent Note that this correspondence holds for both symmetric and non-symmetric special dagger Frobenius algebras, which are commutative and non-commutative $C^*$ algebras respectively.

\begin{theorem}[{\cite[Thm 5.1]{coecke2013new}}]
Symmetric dagger Frobenius algebras in FHilb are orthogonal bases.
\end{theorem}
\noindent The additional condition of specialness for classical structures acts as a normalizing condition so that:
\begin{theorem}[{\cite[Sec 6]{coecke2013new}}]
\label{thm:cstructBases}
Classical structures in FHilb are orthonormal bases.
\end{theorem}

\noindent \noindent Classical structures are bases in \cat{FHilb} and so are recognized as generalized \emph{observables} in an oGCT. The copyable states of classical structures  (Definition~\ref{def:copyables}) form the elements of these bases, more specifically the eigenvectors of the observables, though we should be careful that in categories other than $\cat{FHilb}$ they do not necessarily have all the familiar properties of bases for Hilbert spaces.  For example, we usually expect to be able to distinguish maps by testing them on basis elements. In general this only holds for certain classical structures:

\begin{defn}
\label{def:enoughclassicalpoints}
A classical structure has \emph{enough classical points} when for all processes $f,g:A\to B$: 
\begin{align}
f=g \qquad \mbox{iff}\qquad \left(\forall \ket{j}\in K_{\circ}:f\circ\ket{j}=g\circ\ket{j}\right)\; 
\end{align}
\end{defn}

\begin{remark}
The correspondence in Theorem \ref{thm:cstructBases} was modified for the infinite dimensional case in \cite{abramsky2012h}, where it still holds. We will only use the the finite dimensional case in this thesis as we are concerned only with algorithms that run on computers of finite size.
\end{remark}

\begin{defn}
In a symmetric monoidal dagger-category, the \emph{dimension} $d(A)$ of an object $A$ equipped with a dagger-Frobenius algebra \whitecomonoid{A} is given by the following composite:
\begin{equation}
\label{eq:dim}
\input{tikz/1_dimension.tikz}
\end{equation}
\end{defn}
\noindent
When the algebra is in fact a classical structure, Equation~\eqref{eq:dim} can be simplified to the composition of the unit and counit:
\begin{equation}
\label{eq:defdim}
d(A) \;= \;
\begin{pic}[xscale={\tikzxscale}, yscale={\tikzyscale}]
\node (t) [whitedot] at (0,1) {};
\node (b) [whitedot] at (0,-1) {};
\draw (t) to (b.center);
\end{pic}
\end{equation}

\begin{remark}
It is important to note that the dimension of a system does not always equal the number of classical states of the associated classical structure. One setting where this does not hold is \cat{FRel}, where this fact plays an important role in its oGCT characterization in Chapter~\ref{chap:mermin}.
\end{remark}

The rules for classical structures can be summarized in a convenient normal form that is in keeping with the sorts of topological equivalences we are used to for diagrams for an oGCT. We recursively define
maps $\tinycomult[whitedot]_n:A\to A^{\otimes n}$ by:
\begin{align}
\tinycomult[whitedot]_0:=\tinycounit[whitedot]
\qquad\qquad
\tinycomult[whitedot]_{n+1}:=\left(\tinycomult[whitedot]_{n}\otimes\idm{A}\right)\circ\tinycomult[whitedot]
\end{align}
where $\tinymult[whitedot]_n$ is similarly defined.
\begin{theorem}[Spider Theorem]
\label{thm:spider}
Given a classical structure, let \newline$f:A^{\otimes n}\to A^{\otimes m}$  be constructed from $\{\tinymult[whitedot],\tinycomult[whitedot],\tinyunit[whitedot],\tinycounit[whitedot]\}$ such that the diagram is connected. Then $f=\tinycomult[whitedot]_m\circ\tinymult[whitedot]_n$.
\end{theorem}

\noindent We then define a neat diagrammatic representation for this normal form.

\begin{proposition}\label{prop:spider}\em 
Given a classical structure on $A$, let
$(\whitedot)_n^m$ denote the `$(n,m)$-legged spider':
\begin{equation}
\input{tikz/2_spiderdef.tikz}
\end{equation}
then any process $A^{\otimes n}\to A^{\otimes m}$ built from $\{\tinymult[whitedot], \tinycomult[whitedot], \tinyunit[whitedot],\tinycounit[whitedot]\}$ which has a connected graph is equal to $(\whitedot)^m_n$. Spider
composition is:
\begin{equation}\label{eq:spidercomp}
 \input{tikz/2_spidercomp.tikz}
\end{equation}
\end{proposition}

The spider rule makes it clear that every classical structure on $A$ can be used to make $A$ dual (Definition~\ref{def:dual}) to itself using cups and caps built from the white dot:
\tikzeq{tikz/2_frobcomp.tikz}

The upper and lower star operations with respect to this white dot cup and cap corresponds in \cat{FHilb} to transposition and conjugation in the white dot  basis respectively. Further it can be shown that transposition with respect to a classical structure is equivalent to the dagger when applied to its classical states:
\begin{equation}
\label{eq:dagfrob}
\input{tikz/2_dagfrobtranspose.tikz}
\end{equation}
\noindent This is of course not true on general states.

\section{Phases}
Phases were introduced in this setting by \cite{coecke2011interacting}.

\begin{defn}
\label{def:phases}
A \emph{phase state} for a Frobenius algebra $\whitecomonoid{A}$ is a state $\ket{\alpha}$ such that:
\begin{equation}
\label{eqn:zphasestate}
\input{tikz/2_phasestate.tikz}
\end{equation}
Each phase state corresponds to a \emph{phase} that is a unitary map in the following form:
\begin{equation}
\label{eqn:zphase}
\input{tikz/2_phase.tikz}
\end{equation}
\end{defn}

\begin{proposition}[Phase groups]
Given a dagger Frobenius algebra $\whitemonoid{A}$ in an oGCT, its phases form a group under the following addition:
\begin{equation}
\input{tikz/2_phasegroups.tikz}
\end{equation}
with unit $\tinyunit[whitedot]$. When the Frobenius algebra is part of a classical structure, then its phases form an abelian group.
\end{proposition}
\begin{proof}
\todo{Include proof or cite CQM notes?}
\end{proof}

Phases can be added to the normal form from Theorem~\ref{thm:spider} to give a decorated spider rule~\cite[Thm 7.11]{coecke2011interacting}:
\begin{equation}
\input{tikz/2_decspider.tikz}
\end{equation}
with composition
\begin{equation}
\input{tikz/2_decspidercomp.tikz}
\end{equation}
This normal form is a powerful simplifying tool and will often be used in the analysis of diagrams of processes in oGCTs.

\section{Complementarity}
The notion of complementary bases can also lifted to the abstract level of classical structures in oGCTs~\cite{coecke2011interacting}. This extension is perhaps best presented as emergent from a suitable generalization of mutual unbiasedness.\footnote{Our presentation in this regard is heavily influenced by the approach in \cite{coecke2015generalised}.}  This means that for two bases $\{\ket{i}\}$ and $\{\ket{j}\}$ on a $D$-dimensional Hilbert space, $\langle i|j\rangle = 1/D$ for all $i,j$. In diagrams we then have:
\tikzeq{tikz/2_mub.tikz}
as the mutual unbiasedness condition, where we have assumed that $D$ is invertible and used \eqref{eq:defdim} and \eqref{eq:unitscalar} to obtain to the right hand form.
\begin{defn}[Complementarity]
\label{def:complementarity}
In an oGCT, two classical structures \whitecomonoid{A} and \graycomonoid{A} are \emph{complementary} when the following equation holds:
\begin{equation}
\label{eq:complementarity}
\input{tikz/2_antipodehopf.tikz}
\qquad \mbox{where} \qquad
\input{tikz/2_antipode.tikz}
\end{equation}
The map $S:A\to A$ is called the \emph{antipode}.
\end{defn}
The Equation \eqref{eq:complementarity} is equivalent to mutual unbiasedness on classical structures that have enough classical points by Definition \ref{def:enoughclassicalpoints}. We show this with a quick calculation:
\tikzeq{tikz/2_complemub.tikz}
where $(*)$ is an application of Theorem \ref{thm:fund}.

%\noindent 
%Note that this is not a symmetric condition between the gray and white structures. %However, thanks to the symmetric property of the dagger-Frobenius algebras, %it is equivalent to the following alternative condition:
%\begin{equation}
%\input{tikz/2_complementarity2.tikz}
%\end{equation}
%The daggers of these equations give rise to two further equivalent conditions.

\begin{defn}\label{def:coherence}
In an oGCT, two classical structures \whitecomonoid{A} and \graycomonoid{A} are \emph{coherent} when the following equations hold:
\begin{equation}
\label{eq:coherence}
 \input{tikz/2_coher.tikz}
\end{equation}
\end{defn}

\begin{proposition}[{\cite[Prop.~3]{coecke2015generalised}}]
\label{prop:cohere}
In \cat{FHilb} if we are given two are self-adjoint operators corresponding to complementary classical structures, then we can always construct a pair of coherent classical structures with the same classical points.
\end{proposition}
\noindent This means that in the oGCT for quantum computation, we can take complementary classical structures to be coherent without loss of generality.

The terminology for the antipode comes from the fact that complementarity requires the classical structures to almost form a Hopf algebra using this antipode. Some complementary classical structures do indeed form Hopf algebras and these ones are called strongly complementary. They will be discussed in Section~\ref{sec:strcomplFT} in detail.

\begin{example}
Complementary observables allow us to construct a generalized from of the controlled-not gate in any oGCT. In \cat{FHilb} we can choose classical structures on the two-dimensional Hilbert space that correspond with the usual Z and X observables:  \begin{align*}
    \tinycomult[whitedot] : &
      \begin{array}{rcl}
        \ket{0} & \mapsto & \ket{00} \\
        \ket{1} & \mapsto & \ket{11}
      \end{array}
&
    \tinymult[graydot] : &
      \begin{array}{rcl}
        \ket{+} & \mapsto & \ket{++} \\
        \ket{-} & \mapsto & \ket{--}
      \end{array}
\\ \\
    \tinycounit[whitedot] : &
      \begin{array}{rcl}
        \ket{0} & \mapsto & 1 \\
        \ket{1} & \mapsto & 1
      \end{array}
&
    \tinycounit[graydot] : &
      \begin{array}{rcl}
        \ket{+} & \mapsto & 1 \\
        \ket{-} & \mapsto & 1
      \end{array}
\\ \\
K_{\dotonly{whitedot}} &= \{\ket{0},\ket{1}\}
& 
K_{\dotonly{graydot}} &= \{\ket{+},\ket{-}\}
\end{align*}

These classical structures are coherent and complementary and can be used to define the controlled-not $\mbox{CNOT}:H_2\otimes H_2\to H_2\otimes H_2$ whose diagram is:
\begin{align}
\input{tikz/2_cnot.tikz}
\end{align}
\noindent where the right system acts as the control. We can verify that this behaves as usual for qubits using Z (the whitedot classical structure as their computational basis.
\begin{align}
\begin{pic}[dotpic]
                \node [style=graydot] (0) at (1, -0) {};
                \node [style=whitedot] (1) at (-1, -0) {};
                \node [point] (2) at (1, -1) {$0$};
                \node (3) at (-1, -1) {};
                \node (4) at (-1, 1) {};
                \node (5) at (1, 1) {};
                \draw (2.north) to (0);
                \draw (0) to (1);
                \draw (3.center) to (1);
                \draw (1) to (4.center);
                \draw (0) to (5.center);
\end{pic}
\;&=\;
\begin{pic}[dotpic]
                \node [style=graydot] (0) at (1, -0) {};
                \node [style=whitedot] (1) at (-1, -0) {};
                \node [whitedot] (2) at (1, -1) {};
                \node (3) at (-1, -1) {};
                \node (4) at (-1, 1) {};
                \node (5) at (1, 1) {};
                \draw (2.north) to (0);
                \draw (0) to (1);
                \draw (3.center) to (1);
                \draw (1) to (4.center);
                \draw (0) to (5.center);
\end{pic}
\;\stackrel{\eqref{eq:coherence}}{=}\;
\begin{pic}[dotpic]
                \node [style=whitedot] (0) at (0, -0) {};
                \node [style=whitedot] (1) at (-1, -0) {};
                \node [whitedot] (2) at (1, 0) {};
                \node (3) at (-1, -1) {};
                \node (4) at (-1, 1) {};
                \node (5) at (1, 1) {};
                \draw (2.north) to (5.center);
                \draw (0) to (1);
                \draw (3.center) to (1);
                \draw (1) to (4.center);
\end{pic}
\;=\;
\begin{pic}[dotpic]
                \node [whitedot] (2) at (1, 0) {};
                \node (3) at (-1, -1) {};
                \node (4) at (-1, 1) {};
                \node (5) at (1, 1) {};
                \draw (2.north) to (5.center);
                \draw (3.center) to (4.center);
\end{pic}
\\
\begin{pic}[dotpic]
                \node [style=graydot] (0) at (1, -0) {};
                \node [style=whitedot] (1) at (-1, -0) {};
                \node [point] (2) at (1, -1) {$1$};
                \node (3) at (-1, -1) {};
                \node (4) at (-1, 1) {};
                \node (5) at (1, 1) {};
                \draw (2.north) to (0);
                \draw (0) to (1);
                \draw (3.center) to (1);
                \draw (1) to (4.center);
                \draw (0) to (5.center);
\end{pic}
\;&=\;
\begin{pic}[dotpic]
                \node [style=graydot] (0) at (1, -0) {};
                \node [style=whitedot] (1) at (-1, -0) {};
                \node [whitedot] (2) at (1, -1) {$\pi$};
                \node (3) at (-1, -1) {};
                \node (4) at (-1, 1) {};
                \node (5) at (1, 1) {};
                \draw (2.north) to (0);
                \draw (0) to (1);
                \draw (3.center) to (1);
                \draw (1) to (4.center);
                \draw (0) to (5.center);
\end{pic}
\;\stackrel{\eqref{eq:coherence}}{=}\;
\begin{pic}[dotpic]
                \node [style=whitedot] (0) at (0, -0) {$\pi$};
                \node [style=whitedot] (1) at (-1, -0) {};
                \node [whitedot] (2) at (1.5, 0) {$\pi$};
                \node (3) at (-1, -1) {};
                \node (4) at (-1, 1) {};
                \node (5) at (1.5, 1) {};
                \draw (2.north) to (5.center);
                \draw (0) to (1);
                \draw (3.center) to (1);
                \draw (1) to (4.center);
\end{pic}
\;=\;
\begin{pic}[dotpic]
                \node [style=whitedot] (1) at (-1, -0) {$\pi$};
                \node [whitedot] (2) at (1.5, 0) {$\pi$};
                \node (3) at (-1, -1) {};
                \node (4) at (-1, 1) {};
                \node (5) at (1.5, 1) {};
                \draw (2.north) to (5.center);
                \draw (3.center) to (1);
                \draw (1) to (4.center);
\end{pic}
\end{align}
This shows that on computational basis elements, the control is left unchanged while a $\pi$ Z-rotation (a computational bit flip) is conditionally applied.
\end{example}

This example construction motivates the following definition on any kind of system in any oGCT:
\begin{defn}
Given two two classical structures \whitecomonoid{A} and \graycomonoid{A} that are complementary and coherent, the generalized \emph{controlled-not} is the map:
\begin{equation}
\label{eq:generalizedcnot}
\sqrt{\ud(A)}\,\,
\begin{pic}[xscale=\tikzxscale, yscale=\tikzyscale]
\node (b) [graydot] at (0,0) {};
\node (w) [whitedot] at (1,1) {};
\draw (-0.75,2) to [out=down, in=left] (b.center);
\draw (b.center) to [out=right, in=left] (w.center);
\draw (w.center) to (1,2);
\draw (b.center) to (0,-1);
\draw (w.center) to [out=right, in=up] (1.75,-1);
\end{pic}
\end{equation}
where we have assumed that a scalar equal to the square root of the dimension exists.
\end{defn}
\noindent This scalar is needed to ensure the unitarity of the controlled-not gate, which we discuss in further details in Section \ref{sec:unitaryoracles}.

\section{Measurements}
\label{sec:measurements}

We have already introduced a notion of post-selected measurement in Definition~\ref{def:bornrule}. This section uses Selinger's CPM (completely positive map) construction~\cite{selinger2007dagger}, to present measurement as a process that outputs classical information~\cite{coecke2012strong}. We will need to be more precise about systems and their duals here so will be more consistent about using wires decorated with the proper arrows. 

Using caps and cups, we can construct the unique ``name" of a process $\rho$ as:
\begin{equation}
\input{tikz/2_mapstateduality.tikz}
\end{equation}
The ``doubling" that occurs here, provides a natural way to represent measurements as completely positive maps. Suppose we wish to measure a system with respect to a classical structure $\graycomonoid{A}$,
whose classical points form an orthonormal basis $\{ \ket{x_i} \}$. The probability
of getting the $i$-th measurement outcome is computed using the Born
rule: 
\begin{equation}
 \mbox{Prob}(i, \rho) = \mbox{Tr}(\ketbra{x_i}{x_i} \rho) 
\end{equation}

We can write this probability distribution as a vector in the basis $\{ \ket{x_i} \}$. That is, a vector whose $i$-th entry is the probability of the $i$-th outcome:
\begin{equation}
M_{\dotonly{graydot}}(\rho) = \sum 
\mbox{Tr}(\ketbra{x_i}{x_i} \rho) \ket{x_i}
\end{equation}

So, $M$ defines a linear map from density matrices to probability distributions. Expanding this graphically, we have:
\begin{equation}
\sum_i \mbox{Tr}\left( \input{tikz/2_Prho.tikz} \right) 
\begin{pic}
\node [style={gray point}] (m) at (0, 1.25) {$i$};
\draw [diredge] (m) to (0,2.25)
\end{pic}
\;=\;
\input{tikz/2_measurementderivation2.tikz}
\end{equation}

\begin{defn}[{\cite{coecke2012strong}}]
  For a classical structure \graycomonoid{A}, a measurement in that classical structure is defined as
  the following map: 
  \begin{equation}
  \input{tikz/2_measurement.tikz}
  \end{equation}
\end{defn}

\section{\todo{Quantum protocols in oGCTs}}


Here we reference some existing work that has been done on quantum protocols in abstract process theories: state transfer, teleportation, etc.

